module binomial_lookup
    use constants, only: int64
    implicit none
    private
    public :: factorial, binomial_lookup_table
    ! Already binomial(67, 30) cannot be stored in a signed int64 anymore.
    ! => create a lookup table for all binomials up to binomial(66, k).

    ! If we have the following pascal triangle

    !                     1
    !                  1     1
    !               1     2     1
    !            1     3     3     1
    !         1     4     6     4     1
    !      1     5    10    10     5     1
    !   1     6    15    20    15     6     1

    ! We can exclude all values which are trivially to compute or
    !   redundant because of symmetry.
    ! Only these values will be stored in a linear vector.

    !                     *
    !                  *     *
    !               *     *     *
    !            *     *     *     *
    !         *     *     6     *     *
    !      *     *    10     *     *     *
    !   *     *    15    20     *     *     *

    ! The storage order is then "row-major" for binomial(n, k) by going through all non-redundant k
    !    for a given n:
    !                     *
    !                  *     *
    !               *     *     *
    !            *     *     *     *
    !         *     *     1     *     *
    !      *     *     2     *     *     *
    !   *     *     3     4     *     *     *


    !
    !
    ! The following python code was used to create the table:
    !
    !  # DO NOT USE scipy.special.binom
    !  # since it uses floats, it is slightly off for larger values.
    !
    !  def f(n, k):
    !     t = k
    !     (n, k, previous_x) = (n - k + 1, 1, 1)
    !     for _i in range(1, t + 1):
    !         x = n * previous_x // k
    !         (n, k, previous_x) = (n + 1, k + 1, x)
    !     return previous_x   ! f = lambda n, k: int(round(scipy.special.binom(n, k)))
    !
    ! largest = 2**63 - 1
    ! n, found = 0, False
    ! while not found :
    !     n += 1
    !     for k in range(2, n // 2 + 1):
    !         if f(n, k) > largest:
    !             found = True
    !             break
    !
    !
    ! N = n - 1
    ! lookup = [f(n, k) for n in range(4, N + 1) for k in range(2, n // 2 + 1)]
    !
    integer(int64), parameter :: binomial_lookup_table(1024) = [ &
            6_int64, 10_int64, 15_int64, 20_int64, &
            21_int64, 35_int64, 28_int64, 56_int64, 70_int64, &
            36_int64, 84_int64, 126_int64, 45_int64, 120_int64, &
            210_int64, 252_int64, 55_int64, 165_int64, 330_int64, &
            462_int64, 66_int64, 220_int64, 495_int64, 792_int64, &
            924_int64, 78_int64, 286_int64, 715_int64, 1287_int64, &
            1716_int64, 91_int64, 364_int64, 1001_int64, 2002_int64, &
            3003_int64, 3432_int64, 105_int64, 455_int64, 1365_int64, &
            3003_int64, 5005_int64, 6435_int64, 120_int64, 560_int64, &
            1820_int64, 4368_int64, 8008_int64, 11440_int64, 12870_int64, &
            136_int64, 680_int64, 2380_int64, 6188_int64, 12376_int64, &
            19448_int64, 24310_int64, 153_int64, 816_int64, 3060_int64, &
            8568_int64, 18564_int64, 31824_int64, 43758_int64, 48620_int64, &
            171_int64, 969_int64, 3876_int64, 11628_int64, 27132_int64, &
            50388_int64, 75582_int64, 92378_int64, 190_int64, 1140_int64, &
            4845_int64, 15504_int64, 38760_int64, 77520_int64, 125970_int64, &
            167960_int64, 184756_int64, 210_int64, 1330_int64, 5985_int64, &
            20349_int64, 54264_int64, 116280_int64, 203490_int64, 293930_int64, &
            352716_int64, 231_int64, 1540_int64, 7315_int64, 26334_int64, &
            74613_int64, 170544_int64, 319770_int64, 497420_int64, 646646_int64, &
            705432_int64, 253_int64, 1771_int64, 8855_int64, 33649_int64, &
            100947_int64, 245157_int64, 490314_int64, 817190_int64, 1144066_int64, &
            1352078_int64, 276_int64, 2024_int64, 10626_int64, 42504_int64, &
            134596_int64, 346104_int64, 735471_int64, 1307504_int64, 1961256_int64, &
            2496144_int64, 2704156_int64, 300_int64, 2300_int64, 12650_int64, &
            53130_int64, 177100_int64, 480700_int64, 1081575_int64, 2042975_int64, &
            3268760_int64, 4457400_int64, 5200300_int64, 325_int64, 2600_int64, &
            14950_int64, 65780_int64, 230230_int64, 657800_int64, 1562275_int64, &
            3124550_int64, 5311735_int64, 7726160_int64, 9657700_int64, 10400600_int64, &
            351_int64, 2925_int64, 17550_int64, 80730_int64, 296010_int64, &
            888030_int64, 2220075_int64, 4686825_int64, 8436285_int64, 13037895_int64, &
            17383860_int64, 20058300_int64, 378_int64, 3276_int64, 20475_int64, &
            98280_int64, 376740_int64, 1184040_int64, 3108105_int64, 6906900_int64, &
            13123110_int64, 21474180_int64, 30421755_int64, 37442160_int64, 40116600_int64, &
            406_int64, 3654_int64, 23751_int64, 118755_int64, 475020_int64, &
            1560780_int64, 4292145_int64, 10015005_int64, 20030010_int64, 34597290_int64, &
            51895935_int64, 67863915_int64, 77558760_int64, 435_int64, 4060_int64, &
            27405_int64, 142506_int64, 593775_int64, 2035800_int64, 5852925_int64, &
            14307150_int64, 30045015_int64, 54627300_int64, 86493225_int64, 119759850_int64, &
            145422675_int64, 155117520_int64, 465_int64, 4495_int64, 31465_int64, &
            169911_int64, 736281_int64, 2629575_int64, 7888725_int64, 20160075_int64, &
            44352165_int64, 84672315_int64, 141120525_int64, 206253075_int64, 265182525_int64, &
            300540195_int64, 496_int64, 4960_int64, 35960_int64, 201376_int64, &
            906192_int64, 3365856_int64, 10518300_int64, 28048800_int64, 64512240_int64, &
            129024480_int64, 225792840_int64, 347373600_int64, 471435600_int64, 565722720_int64, &
            601080390_int64, 528_int64, 5456_int64, 40920_int64, 237336_int64, &
            1107568_int64, 4272048_int64, 13884156_int64, 38567100_int64, 92561040_int64, &
            193536720_int64, 354817320_int64, 573166440_int64, 818809200_int64, 1037158320_int64, &
            1166803110_int64, 561_int64, 5984_int64, 46376_int64, 278256_int64, &
            1344904_int64, 5379616_int64, 18156204_int64, 52451256_int64, 131128140_int64, &
            286097760_int64, 548354040_int64, 927983760_int64, 1391975640_int64, 1855967520_int64, &
            2203961430_int64, 2333606220_int64, 595_int64, 6545_int64, 52360_int64, &
            324632_int64, 1623160_int64, 6724520_int64, 23535820_int64, 70607460_int64, &
            183579396_int64, 417225900_int64, 834451800_int64, 1476337800_int64, 2319959400_int64, &
            3247943160_int64, 4059928950_int64, 4537567650_int64, 630_int64, 7140_int64, &
            58905_int64, 376992_int64, 1947792_int64, 8347680_int64, 30260340_int64, &
            94143280_int64, 254186856_int64, 600805296_int64, 1251677700_int64, 2310789600_int64, &
            3796297200_int64, 5567902560_int64, 7307872110_int64, 8597496600_int64, 9075135300_int64, &
            666_int64, 7770_int64, 66045_int64, 435897_int64, 2324784_int64, &
            10295472_int64, 38608020_int64, 124403620_int64, 348330136_int64, 854992152_int64, &
            1852482996_int64, 3562467300_int64, 6107086800_int64, 9364199760_int64, 12875774670_int64, &
            15905368710_int64, 17672631900_int64, 703_int64, 8436_int64, 73815_int64, &
            501942_int64, 2760681_int64, 12620256_int64, 48903492_int64, 163011640_int64, &
            472733756_int64, 1203322288_int64, 2707475148_int64, 5414950296_int64, 9669554100_int64, &
            15471286560_int64, 22239974430_int64, 28781143380_int64, 33578000610_int64, 35345263800_int64, &
            741_int64, 9139_int64, 82251_int64, 575757_int64, 3262623_int64, &
            15380937_int64, 61523748_int64, 211915132_int64, 635745396_int64, 1676056044_int64, &
            3910797436_int64, 8122425444_int64, 15084504396_int64, 25140840660_int64, 37711260990_int64, &
            51021117810_int64, 62359143990_int64, 68923264410_int64, 780_int64, 9880_int64, &
            91390_int64, 658008_int64, 3838380_int64, 18643560_int64, 76904685_int64, &
            273438880_int64, 847660528_int64, 2311801440_int64, 5586853480_int64, 12033222880_int64, &
            23206929840_int64, 40225345056_int64, 62852101650_int64, 88732378800_int64, 113380261800_int64, &
            131282408400_int64, 137846528820_int64, 820_int64, 10660_int64, 101270_int64, &
            749398_int64, 4496388_int64, 22481940_int64, 95548245_int64, 350343565_int64, &
            1121099408_int64, 3159461968_int64, 7898654920_int64, 17620076360_int64, 35240152720_int64, &
            63432274896_int64, 103077446706_int64, 151584480450_int64, 202112640600_int64, 244662670200_int64, &
            269128937220_int64, 861_int64, 11480_int64, 111930_int64, 850668_int64, &
            5245786_int64, 26978328_int64, 118030185_int64, 445891810_int64, 1471442973_int64, &
            4280561376_int64, 11058116888_int64, 25518731280_int64, 52860229080_int64, 98672427616_int64, &
            166509721602_int64, 254661927156_int64, 353697121050_int64, 446775310800_int64, 513791607420_int64, &
            538257874440_int64, 903_int64, 12341_int64, 123410_int64, 962598_int64, &
            6096454_int64, 32224114_int64, 145008513_int64, 563921995_int64, 1917334783_int64, &
            5752004349_int64, 15338678264_int64, 36576848168_int64, 78378960360_int64, 151532656696_int64, &
            265182149218_int64, 421171648758_int64, 608359048206_int64, 800472431850_int64, 960566918220_int64, &
            1052049481860_int64, 946_int64, 13244_int64, 135751_int64, 1086008_int64, &
            7059052_int64, 38320568_int64, 177232627_int64, 708930508_int64, 2481256778_int64, &
            7669339132_int64, 21090682613_int64, 51915526432_int64, 114955808528_int64, 229911617056_int64, &
            416714805914_int64, 686353797976_int64, 1029530696964_int64, 1408831480056_int64, 1761039350070_int64, &
            2012616400080_int64, 2104098963720_int64, 990_int64, 14190_int64, 148995_int64, &
            1221759_int64, 8145060_int64, 45379620_int64, 215553195_int64, 886163135_int64, &
            3190187286_int64, 10150595910_int64, 28760021745_int64, 73006209045_int64, 166871334960_int64, &
            344867425584_int64, 646626422970_int64, 1103068603890_int64, 1715884494940_int64, 2438362177020_int64, &
            3169870830126_int64, 3773655750150_int64, 4116715363800_int64, 1035_int64, 15180_int64, &
            163185_int64, 1370754_int64, 9366819_int64, 53524680_int64, 260932815_int64, &
            1101716330_int64, 4076350421_int64, 13340783196_int64, 38910617655_int64, 101766230790_int64, &
            239877544005_int64, 511738760544_int64, 991493848554_int64, 1749695026860_int64, 2818953098830_int64, &
            4154246671960_int64, 5608233007146_int64, 6943526580276_int64, 7890371113950_int64, 8233430727600_int64, &
            1081_int64, 16215_int64, 178365_int64, 1533939_int64, 10737573_int64, &
            62891499_int64, 314457495_int64, 1362649145_int64, 5178066751_int64, 17417133617_int64, &
            52251400851_int64, 140676848445_int64, 341643774795_int64, 751616304549_int64, 1503232609098_int64, &
            2741188875414_int64, 4568648125690_int64, 6973199770790_int64, 9762479679106_int64, 12551759587422_int64, &
            14833897694226_int64, 16123801841550_int64, 1128_int64, 17296_int64, 194580_int64, &
            1712304_int64, 12271512_int64, 73629072_int64, 377348994_int64, 1677106640_int64, &
            6540715896_int64, 22595200368_int64, 69668534468_int64, 192928249296_int64, 482320623240_int64, &
            1093260079344_int64, 2254848913647_int64, 4244421484512_int64, 7309837001104_int64, 11541847896480_int64, &
            16735679449896_int64, 22314239266528_int64, 27385657281648_int64, 30957699535776_int64, 32247603683100_int64, &
            1176_int64, 18424_int64, 211876_int64, 1906884_int64, 13983816_int64, &
            85900584_int64, 450978066_int64, 2054455634_int64, 8217822536_int64, 29135916264_int64, &
            92263734836_int64, 262596783764_int64, 675248872536_int64, 1575580702584_int64, 3348108992991_int64, &
            6499270398159_int64, 11554258485616_int64, 18851684897584_int64, 28277527346376_int64, 39049918716424_int64, &
            49699896548176_int64, 58343356817424_int64, 63205303218876_int64, 1225_int64, 19600_int64, &
            230300_int64, 2118760_int64, 15890700_int64, 99884400_int64, 536878650_int64, &
            2505433700_int64, 10272278170_int64, 37353738800_int64, 121399651100_int64, 354860518600_int64, &
            937845656300_int64, 2250829575120_int64, 4923689695575_int64, 9847379391150_int64, 18053528883775_int64, &
            30405943383200_int64, 47129212243960_int64, 67327446062800_int64, 88749815264600_int64, 108043253365600_int64, &
            121548660036300_int64, 126410606437752_int64, 1275_int64, 20825_int64, 249900_int64, &
            2349060_int64, 18009460_int64, 115775100_int64, 636763050_int64, 3042312350_int64, &
            12777711870_int64, 47626016970_int64, 158753389900_int64, 476260169700_int64, 1292706174900_int64, &
            3188675231420_int64, 7174519270695_int64, 14771069086725_int64, 27900908274925_int64, 48459472266975_int64, &
            77535155627160_int64, 114456658306760_int64, 156077261327400_int64, 196793068630200_int64, 229591913401900_int64, &
            247959266474052_int64, 1326_int64, 22100_int64, 270725_int64, 2598960_int64, &
            20358520_int64, 133784560_int64, 752538150_int64, 3679075400_int64, 15820024220_int64, &
            60403728840_int64, 206379406870_int64, 635013559600_int64, 1768966344600_int64, 4481381406320_int64, &
            10363194502115_int64, 21945588357420_int64, 42671977361650_int64, 76360380541900_int64, 125994627894135_int64, &
            191991813933920_int64, 270533919634160_int64, 352870329957600_int64, 426384982032100_int64, 477551179875952_int64, &
            495918532948104_int64, 1378_int64, 23426_int64, 292825_int64, 2869685_int64, &
            22957480_int64, 154143080_int64, 886322710_int64, 4431613550_int64, 19499099620_int64, &
            76223753060_int64, 266783135710_int64, 841392966470_int64, 2403979904200_int64, 6250347750920_int64, &
            14844575908435_int64, 32308782859535_int64, 64617565719070_int64, 119032357903550_int64, 202355008436035_int64, &
            317986441828055_int64, 462525733568080_int64, 623404249591760_int64, 779255311989700_int64, 903936161908052_int64, &
            973469712824056_int64, 1431_int64, 24804_int64, 316251_int64, 3162510_int64, &
            25827165_int64, 177100560_int64, 1040465790_int64, 5317936260_int64, 23930713170_int64, &
            95722852680_int64, 343006888770_int64, 1108176102180_int64, 3245372870670_int64, 8654327655120_int64, &
            21094923659355_int64, 47153358767970_int64, 96926348578605_int64, 183649923622620_int64, 321387366339585_int64, &
            520341450264090_int64, 780512175396135_int64, 1085929983159840_int64, 1402659561581460_int64, 1683191473897752_int64, &
            1877405874732108_int64, 1946939425648112_int64, 1485_int64, 26235_int64, 341055_int64, &
            3478761_int64, 28989675_int64, 202927725_int64, 1217566350_int64, 6358402050_int64, &
            29248649430_int64, 119653565850_int64, 438729741450_int64, 1451182990950_int64, 4353548972850_int64, &
            11899700525790_int64, 29749251314475_int64, 68248282427325_int64, 144079707346575_int64, 280576272201225_int64, &
            505037289962205_int64, 841728816603675_int64, 1300853625660225_int64, 1866442158555975_int64, 2488589544741300_int64, &
            3085851035479212_int64, 3560597348629860_int64, 3824345300380220_int64, 1540_int64, 27720_int64, &
            367290_int64, 3819816_int64, 32468436_int64, 231917400_int64, 1420494075_int64, &
            7575968400_int64, 35607051480_int64, 148902215280_int64, 558383307300_int64, 1889912732400_int64, &
            5804731963800_int64, 16253249498640_int64, 41648951840265_int64, 97997533741800_int64, 212327989773900_int64, &
            424655979547800_int64, 785613562163430_int64, 1346766106565880_int64, 2142582442263900_int64, 3167295784216200_int64, &
            4355031703297275_int64, 5574440580220512_int64, 6646448384109072_int64, 7384942649010080_int64, 7648690600760440_int64, &
            1596_int64, 29260_int64, 395010_int64, 4187106_int64, 36288252_int64, &
            264385836_int64, 1652411475_int64, 8996462475_int64, 43183019880_int64, 184509266760_int64, &
            707285522580_int64, 2448296039700_int64, 7694644696200_int64, 22057981462440_int64, 57902201338905_int64, &
            139646485582065_int64, 310325523515700_int64, 636983969321700_int64, 1210269541711230_int64, 2132379668729310_int64, &
            3489348548829780_int64, 5309878226480100_int64, 7522327487513475_int64, 9929472283517787_int64, 12220888964329584_int64, &
            14031391033119152_int64, 15033633249770520_int64, 1653_int64, 30856_int64, 424270_int64, &
            4582116_int64, 40475358_int64, 300674088_int64, 1916797311_int64, 10648873950_int64, &
            52179482355_int64, 227692286640_int64, 891794789340_int64, 3155581562280_int64, 10142940735900_int64, &
            29752626158640_int64, 79960182801345_int64, 197548686920970_int64, 449972009097765_int64, 947309492837400_int64, &
            1847253511032930_int64, 3342649210440540_int64, 5621728217559090_int64, 8799226775309880_int64, 12832205713993575_int64, &
            17451799771031262_int64, 22150361247847371_int64, 26252279997448736_int64, 29065024282889672_int64, 30067266499541040_int64, &
            1711_int64, 32509_int64, 455126_int64, 5006386_int64, 45057474_int64, &
            341149446_int64, 2217471399_int64, 12565671261_int64, 62828356305_int64, 279871768995_int64, &
            1119487075980_int64, 4047376351620_int64, 13298522298180_int64, 39895566894540_int64, 109712808959985_int64, &
            277508869722315_int64, 647520696018735_int64, 1397281501935165_int64, 2794563003870330_int64, 5189902721473470_int64, &
            8964377427999630_int64, 14420954992868970_int64, 21631432489303455_int64, 30284005485024837_int64, 39602161018878633_int64, &
            48402641245296107_int64, 55317304280338408_int64, 59132290782430712_int64, 1770_int64, 34220_int64, &
            487635_int64, 5461512_int64, 50063860_int64, 386206920_int64, 2558620845_int64, &
            14783142660_int64, 75394027566_int64, 342700125300_int64, 1399358844975_int64, 5166863427600_int64, &
            17345898649800_int64, 53194089192720_int64, 149608375854525_int64, 387221678682300_int64, 925029565741050_int64, &
            2044802197953900_int64, 4191844505805495_int64, 7984465725343800_int64, 14154280149473100_int64, 23385332420868600_int64, &
            36052387482172425_int64, 51915437974328292_int64, 69886166503903470_int64, 88004802264174740_int64, 103719945525634515_int64, &
            114449595062769120_int64, 118264581564861424_int64, 1830_int64, 35990_int64, 521855_int64, &
            5949147_int64, 55525372_int64, 436270780_int64, 2944827765_int64, 17341763505_int64, &
            90177170226_int64, 418094152866_int64, 1742058970275_int64, 6566222272575_int64, 22512762077400_int64, &
            70539987842520_int64, 202802465047245_int64, 536830054536825_int64, 1312251244423350_int64, 2969831763694950_int64, &
            6236646703759395_int64, 12176310231149295_int64, 22138745874816900_int64, 37539612570341700_int64, 59437719903041025_int64, &
            87967825456500717_int64, 121801604478231762_int64, 157890968768078210_int64, 191724747789809255_int64, 218169540588403635_int64, &
            232714176627630544_int64, 1891_int64, 37820_int64, 557845_int64, 6471002_int64, &
            61474519_int64, 491796152_int64, 3381098545_int64, 20286591270_int64, 107518933731_int64, &
            508271323092_int64, 2160153123141_int64, 8308281242850_int64, 29078984349975_int64, 93052749919920_int64, &
            273342452889765_int64, 739632519584070_int64, 1849081298960175_int64, 4282083008118300_int64, 9206478467454345_int64, &
            18412956934908690_int64, 34315056105966195_int64, 59678358445158600_int64, 96977332473382725_int64, 147405545359541742_int64, &
            209769429934732479_int64, 279692573246309972_int64, 349615716557887465_int64, 409894288378212890_int64, 450883717216034179_int64, &
            465428353255261088_int64, 1953_int64, 39711_int64, 595665_int64, 7028847_int64, &
            67945521_int64, 553270671_int64, 3872894697_int64, 23667689815_int64, 127805525001_int64, &
            615790256823_int64, 2668424446233_int64, 10468434365991_int64, 37387265592825_int64, 122131734269895_int64, &
            366395202809685_int64, 1012974972473835_int64, 2588713818544245_int64, 6131164307078475_int64, 13488561475572645_int64, &
            27619435402363035_int64, 52728013040874885_int64, 93993414551124795_int64, 156655690918541325_int64, 244382877832924467_int64, &
            357174975294274221_int64, 489462003181042451_int64, 629308289804197437_int64, 759510004936100355_int64, 860778005594247069_int64, &
            916312070471295267_int64, 2016_int64, 41664_int64, 635376_int64, 7624512_int64, &
            74974368_int64, 621216192_int64, 4426165368_int64, 27540584512_int64, 151473214816_int64, &
            743595781824_int64, 3284214703056_int64, 13136858812224_int64, 47855699958816_int64, 159518999862720_int64, &
            488526937079580_int64, 1379370175283520_int64, 3601688791018080_int64, 8719878125622720_int64, 19619725782651120_int64, &
            41107996877935680_int64, 80347448443237920_int64, 146721427591999680_int64, 250649105469666120_int64, 401038568751465792_int64, &
            601557853127198688_int64, 846636978475316672_int64, 1118770292985239888_int64, 1388818294740297792_int64, 1620288010530347424_int64, &
            1777090076065542336_int64, 1832624140942590534_int64, 2080_int64, 43680_int64, 677040_int64, &
            8259888_int64, 82598880_int64, 696190560_int64, 5047381560_int64, 31966749880_int64, &
            179013799328_int64, 895068996640_int64, 4027810484880_int64, 16421073515280_int64, 60992558771040_int64, &
            207374699821536_int64, 648045936942300_int64, 1867897112363100_int64, 4981058966301600_int64, 12321566916640800_int64, &
            28339603908273840_int64, 60727722660586800_int64, 121455445321173600_int64, 227068876035237600_int64, 397370533061665800_int64, &
            651687674221131912_int64, 1002596421878664480_int64, 1448194831602515360_int64, 1965407271460556560_int64, 2507588587725537680_int64, &
            3009106305270645216_int64, 3397378086595889760_int64, 3609714217008132870_int64, 2145_int64, 45760_int64, &
            720720_int64, 8936928_int64, 90858768_int64, 778789440_int64, 5743572120_int64, &
            37014131440_int64, 210980549208_int64, 1074082795968_int64, 4922879481520_int64, 20448884000160_int64, &
            77413632286320_int64, 268367258592576_int64, 855420636763836_int64, 2515943049305400_int64, 6848956078664700_int64, &
            17302625882942400_int64, 40661170824914640_int64, 89067326568860640_int64, 182183167981760400_int64, 348524321356411200_int64, &
            624439409096903400_int64, 1049058207282797712_int64, 1654284096099796392_int64, 2450791253481179840_int64, 3413602103063071920_int64, &
            4472995859186094240_int64, 5516694892996182896_int64, 6406484391866534976_int64, 7007092303604022630_int64, 7219428434016265740_int64 &
    ]


    ! factorial(21) is the largest number that is contained in a signed int64
    ! This is one of the rare occasions where the Fortran Array Access syntax is helpful
    ! since the user can use this array, as if it was a function.
    !
    ! Generated with the followingp python code:
    !     largest = 2**63 - 1
    !     n, found = 0, False
    !     while not found :
    !         n += 1
    !         if faculty(n) > largest:
    !             print(n)
    !             found = True
    !             break
    !     lookup = [faculty(i) for i in range(n)]

    integer(int64), parameter :: factorial(0:20) = [ &
        1_int64, 1_int64, 2_int64, 6_int64, &
        24_int64, 120_int64, 720_int64, 5040_int64, 40320_int64, &
        362880_int64, 3628800_int64, 39916800_int64, 479001600_int64, 6227020800_int64, &
        87178291200_int64, 1307674368000_int64, 20922789888000_int64, 355687428096000_int64, 6402373705728000_int64, &
        121645100408832000_int64, 2432902008176640000_int64 &
    ]
    contains
end module
