      PROGRAM NECICUBE
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER IPARITY(5)
      INTEGER NTAY(2)
      LOGICAL TSPN,TALPHA,TPARITY,TCORR,TFODM,TCALCHMAT,TUEG,
     &   TREAD,TRHOOFR,TENERGY,TMC,TRHOIJ,TREADRHO,TMONTE,TTROT,
     &   TBEGRAPH,THFBASIS,THUB,TNPDERIV,TMCDET,THFCALC,TTILT,
     &   TBLOCK,TREADINT,TPBC,TREAL,TRHF,TREADHF,TSPECDET,TREADTUMAT,
     &   THFORDER,TCSF,TSPECDET2,TDFREAD,TBIN
      CHARACTER*255 INP
      INTEGER NPATHs,STOT
      INTEGER MDK(5),DETINV,ORBORDER(8,2)
      INTEGER SPECDET(*)
      INTEGER NWHTAY(3,10)
      REAL*8 ORBORDER2(8)
      POINTER (IP_SPECDET,SPECDET)
      REAL*8 FUEGRS
      LOGICAL TCPMD
      CHARACTER*255 FILENAME
      INTEGER ios
      REAL*8 DBETA(3),fRc
      INCLUDE 'vmc.inc'
      INCLUDE 'fcoul.inc'

C      INTEGER NHG
C      CALL FAKEREADCHARTABLE(NHG)
C      CALL GENIRREPS
C      CALL GENSYMTABLE
C      STOP
C.. Cleanup from a previous run
C      i=unlink("MCPATHS")
C      OPEN(1,FILE="MCPATHS",STATUS='NEW')
C      CLOSE(1)

      FILENAME=""
      WRITE(6,*) "STARTING NECI"
      CALL READINPUT(FILENAME,NEL,TSPN,LMS,TPARITY,IPARITY,NMAXX,NMAXY,
     &   NMAXZ,
     &  NMSH,BOX,BOA,COA,TALPHA,ALPHA,ISTATE,NEVAL,B2L,NCYCLE,NBLK,
     &  NKRY,TRHOOFR,TREAD,TCORR,TFODM,IOBS,JOBS,KOBS,TENERGY,TMC,
     &  NHISTBOXES,BETA,I_P,TRHOIJ,RHOEPSILON,TREADRHO,NPATHS,TMONTE,
     &  IMCSTEPS,IEQSTEPS,TTROT,I_HMAX,TCALCHMAT,NTAY,NWHTAY,I_VMAX,
     &  ILOGGING,TUEG,TBEGRAPH,THFBASIS,THUB,UHUB,BHUB,ETRIAL,TNPDERIV,
     & BETAP,BETAEQ,TMCDET,MDK,DETINV,THFCALC,NHFIT,TTILT,ITILTX,ITILTY,
     & TBLOCK,HFMIX,HFEDELTA,TREADINT,TPBC,TREAL,NDETWORK,ORBORDER,
     &   NFROZEN,NTFROZEN,TRHF,HFCDELTA,IHFMETHOD,TREADHF,TSPECDET,
     &  IP_SPECDET,DBETA,TREADTUMAT,THFORDER,TCSF,STOT,ICILEVEL,FUEGRS,
     &   TCPMD,ios,TDFREAD,fRc,TBIN)

C      CALL READOLDINPUT(NEL,TSPN,LMS,TPARITY,IPARITY,NMAXX,NMAXY,
C     &   NMAXZ,
C     &  NMSH,BOX,BOA,COA,TALPHA,ALPHA,ISTATE,NEVAL,B2L,NCYCLE,NBLK,
C     &  NKRY,TRHOOFR,TREAD,TCORR,TFODM,IOBS,JOBS,KOBS,TENERGY,TMC,
C     &  NHISTBOXES,BETA,I_P,TRHOIJ,RHOEPSILON,TREADRHO,NPATHS,TMONTE,
C     &  IMCSTEPS,IEQSTEPS,TTROT,I_HMAX,TCALCHMAT,NTAY,NWHTAY,I_VMAX,
C     &  ILOGGING,TUEG,TBEGRAPH,THFBASIS,THUB,UHUB,BHUB,ETRIAL,TNPDERIV,
C     & BETAP,BETAEQ,TMCDET,MDK,DETINV,THFCALC,NHFIT,TTILT,ITILTX,ITILTY,
C     & TBLOCK,HFMIX,HFEDELTA,TREADINT,TPBC,TREAL,NDETWORK,ORBORDER,
C     &   NFROZEN,NTFROZEN,TRHF,HFCDELTA,IHFMETHOD,TREADHF,TSPECDET,
C     &  IP_SPECDET,DBETA,TREADTUMAT,THFORDER,TCSF,STOT,ICILEVEL,FUEGRS)

      CALL NECICB(NEL,TSPN,LMS,TPARITY,IPARITY,NMAXX,NMAXY,NMAXZ,
     &	NMSH,BOX,BOA,COA,TALPHA,ALPHA,ISTATE,NEVAL,B2L,NCYCLE,NBLK,
     &	NKRY,TRHOOFR,TREAD,TCORR,TFODM,IOBS,JOBS,KOBS,TENERGY,TMC,
     &	NHISTBOXES,BETA,I_P,TRHOIJ,RHOEPSILON,TREADRHO,NPATHS,TMONTE,
     &  IMCSTEPS,IEQSTEPS,TTROT,I_HMAX,TCALCHMAT,NTAY,NWHTAY,I_VMAX,
     &  ILOGGING,TUEG,TBEGRAPH,THFBASIS,THUB,UHUB,BHUB,ETRIAL,TNPDERIV,
     & BETAP,BETAEQ,TMCDET,MDK,DETINV,THFCALC,NHFIT,TTILT,ITILTX,ITILTY,
     & TBLOCK,HFMIX,HFEDELTA,TREADINT,TPBC,TREAL,NDETWORK,ORBORDER,
     &   NFROZEN,NTFROZEN,TRHF,HFCDELTA,IHFMETHOD,TREADHF,TSPECDET,
     &   SPECDET,DBETA,TREADTUMAT,THFORDER,TCSF,STOT,ICILEVEL,FUEGRS,
     &   TCPMD,TDFREAD,fRc,0,TBIN)
C..
      END
