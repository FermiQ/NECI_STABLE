      SUBROUTINE RLSXC_SC(NEL,NMSH,NMAX,SITAB,IOBS,JOBS,KOBS,
     &	NDET,NDET1,G1,NHG,AUXC)
      use SystemData, only: BasisFN
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION NDET1(NEL),AUXC(NMSH,NMSH,NMSH)
      DIMENSION SITAB(NMSH,NMAX)
      TYPE(BasisFN) G1(NHG)
C..
      CALL AZZERO(AUXC,NMSH*NMSH*NMSH)
      DO KI=1,NEL-1
        DO KJ=KI+1,NEL
C..
          CALL CHK(G1(NDET1(KI))%Ms,G1(NDET1(KJ))%Ms,IDS)
          DO IZ=1,NMSH
	    DO IY=1,NMSH
	      DO IX=1,NMSH
C..
C..U1KIR1=U1(NDET1(KI),NMAX,LMAX,G1,RAD,R1Z)
		U1KIR1=U1(NDET1(KI),NMAX,NMSH,NHG,G1,SITAB,
     &			IOBS,JOBS,KOBS)
C..U2KJR2=U2(NDET1(KJ),NMAX,LMAX,G1,RAD,R2,THT)
		U2KJR2=U1(NDET1(KJ),NMAX,NMSH,NHG,G1,SITAB,IX,IY,IZ)
C..U1KJR1=U1(NDET1(KJ),NMAX,LMAX,G1,RAD,R1Z)
  		U1KJR1=U1(NDET1(KJ),NMAX,NMSH,NHG,G1,SITAB,
     &			IOBS,JOBS,KOBS)
C..U2KIR2=U2(NDET1(KI),NMAX,LMAX,G1,RAD,R2,THT)
		U2KIR2=U1(NDET1(KI),NMAX,NMSH,NHG,G1,SITAB,IX,IY,IZ)
C..
		AUXC(IX,IY,IZ)=AUXC(IX,IY,IZ)+
     &			U1KIR1*U1KIR1*U2KJR2*U2KJR2+
     &			U1KJR1*U1KJR1*U2KIR2*U2KIR2-
     &		 	U1KIR1*U1KJR1*U2KJR2*U2KIR2*DFLOAT(IDS)-
     &			U1KJR1*U1KIR1*U2KIR2*U2KJR2*DFLOAT(IDS)	
	      ENDDO
            ENDDO
          ENDDO
C..
        ENDDO
      ENDDO
      RETURN
      END	
C ==-----------------------------------------------------------------==
      FUNCTION U1(ND,NX,NMSH,NHG,G1,SITAB,I,J,K)
      use SystemData, only: BasisFN
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION SITAB(NMSH,NX)
      TYPE(BasisFN) G1(NHG)
C..
      U1=
     &	SITAB(I,G1(ND)%k(1))*SITAB(J,G1(ND)%k(2))*SITAB(K,G1(ND)%k(3))
      RETURN
      END
